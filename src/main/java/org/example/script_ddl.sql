-- Criação da tabela de clientes
CREATE TABLE TB_CLIENTE (
    ID_CLIENTE NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME       VARCHAR2(100) NOT NULL,
    EMAIL      VARCHAR2(100) UNIQUE NOT NULL,
    CPF        VARCHAR2(11) UNIQUE NOT NULL,
    TELEFONE   VARCHAR2(20)
);

-- Criação da tabela de pedidos 
CREATE TABLE TB_PEDIDO (
    ID_PEDIDO   NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_CLIENTE  NUMBER NOT NULL,
    DATA_PEDIDO DATE DEFAULT SYSDATE,
    VALOR_TOTAL NUMBER(10,2) NOT NULL,

    CONSTRAINT FK_PEDIDO_CLIENTE FOREIGN KEY (ID_CLIENTE)
        REFERENCES TB_CLIENTE(ID_CLIENTE)
);

-- Criação da tabela de produtos
CREATE TABLE TB_PRODUTO (
    ID_PRODUTO  NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME        VARCHAR2(100) NOT NULL,
    PRECO       NUMBER(10,2) NOT NULL
);

-- Criação da tabela de itens do pedido 
CREATE TABLE TB_ITEM_PEDIDO (
    ID_ITEM     NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ID_PEDIDO   NUMBER NOT NULL,
    ID_PRODUTO  NUMBER NOT NULL,
    QUANTIDADE  NUMBER NOT NULL,
    SUBTOTAL    NUMBER(10,2) NOT NULL,

    CONSTRAINT FK_ITEM_PEDIDO FOREIGN KEY (ID_PEDIDO)
        REFERENCES TB_PEDIDO(ID_PEDIDO),
    CONSTRAINT FK_ITEM_PRODUTO FOREIGN KEY (ID_PRODUTO)
        REFERENCES TB_PRODUTO(ID_PRODUTO)
);

-- Vizualização da tabela 
SELECT table_name FROM user_tables;